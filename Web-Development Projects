<?php

// Home page
// Sebastian Pineda
// Week 8: Introduction to PHP

$name = "Sebastian Pineda";
$title = "Home Page";
$file = "index.php";
$date = "Oct 27, 2025";
$description = "Index Page";
$banner = "Week 8: Introduction to PHP";


include("./includes/header.php");


$conn = pg_connect("host=127.0.0.1 port=5432 dbname=pinedas_db user=pinedas password=100797342");
if (!$conn) {
    die("<div class='alert alert-danger'>Database connection failed.</div>");
}


$sql = "SELECT * FROM movies ORDER BY year ASC";
pg_prepare($conn, "get_movies", $sql);
$result = pg_execute($conn, "get_movies", array());


echo "<table class='table table-striped mt-3'>
        <thead><tr><th>NUM</th><th>TITLE</th><th>YEAR</th></tr></thead><tbody>";

while ($row = pg_fetch_assoc($result)) {
    echo "<tr>
            <td>{$row['movie_num']}</td>
            <td>{$row['title']}</td>
            <td>{$row['year']}</td>
          </tr>";
}

echo "</tbody></table>";


include("./includes/footer.php");
