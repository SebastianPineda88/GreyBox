// XML FILE 

<Window x:Class="CarList2025.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CarList2025"
        mc:Ignorable="d"
        Title="Car Inventory" WindowStartupLocation="CenterScreen"
        MinHeight="400" MinWidth="300"
        Height="400" Width="500">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="35"/>
        </Grid.RowDefinitions>

    <StackPanel VerticalAlignment="Center" >

        <!-- Item 1: The Input Grid-->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition MinWidth="50" Width="100"/>
                <ColumnDefinition MinWidth="70" Width="100" MaxWidth="300"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <!-- Row 0 -->
            <Label Content="_Make:" Grid.Row="0" Grid.Column="1" Target="{Binding ElementName=comboMake}" HorizontalAlignment="Right" VerticalAlignment="Center"/>

            <!-- Make is a ComboBox.-->
            <!--<TextBox x:Name="textMake" IsReadOnly="True" MinWidth="60" Grid.Row="0" Grid.Column="2"  Margin="5" ToolTip="Displays the make of the car." VerticalContentAlignment="Center"/>-->
            <ComboBox x:Name="comboMake" Grid.Column="2" HorizontalAlignment="Stretch" Margin="3" ToolTip="Select the manufacturer of the car." >
                <ComboBoxItem>BMW</ComboBoxItem>
                <ComboBoxItem>Honda</ComboBoxItem>
                <ComboBoxItem>Hyundai</ComboBoxItem>
                <ComboBoxItem>Ford</ComboBoxItem>
                <ComboBoxItem>Dodge</ComboBoxItem>
                <ComboBoxItem>Ferrari</ComboBoxItem>
                <ComboBoxItem>Porshe</ComboBoxItem>
                <ComboBoxItem>Rolls Royce</ComboBoxItem>
                <ComboBoxItem>Kia</ComboBoxItem>
                <ComboBoxItem>Lamborghini</ComboBoxItem>
                <ComboBoxItem>DMC</ComboBoxItem>
            </ComboBox>

            <!-- Row 1 -->
            <Label Content="M_odel:" Grid.Row="1" Grid.Column="1" Target="{Binding ElementName=textModel}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            <TextBox x:Name="textModel" MinWidth="60" Grid.Row="1" Grid.Column="2" Margin="5" ToolTip="Displays the model of the car" VerticalContentAlignment="Center"/>
            <!-- Row 2 -->
            <Label Content="_Year:" Grid.Row="2" Grid.Column="1" Target="{Binding ElementName=comboYear}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            <!--<TextBox x:Name="textYear" IsReadOnly="True" MinWidth="60" Grid.Row="2" Grid.Column="2" Margin="5" ToolTip="Displays the year of the car" VerticalContentAlignment="Center"/>-->
            <ComboBox x:Name="comboYear" Grid.Column="2" Grid.Row="2" HorizontalAlignment="Stretch" Margin="3" ToolTip="Select the year the car was produced." />

            <!-- Row 3 -->
            <Label Content="_Price:" Grid.Row="3" Grid.Column="1" Target="{Binding ElementName=textPrice}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            <TextBox x:Name="textPrice" MinWidth="60" Grid.Row="3" Grid.Column="2" Margin="5" ToolTip="Displays the price of the car" VerticalContentAlignment="Center"/>
            <!-- Row 4 -->
            <CheckBox x:Name="checkIsNew" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Center" Grid.Row="4" Content="_New?"  />

        </Grid>
        <!-- Item 2: The List -->
        <ListView x:Name="listViewCars" Margin="3" MinHeight="120">
            <ListView.View>
                <GridView>
                    <GridViewColumn DisplayMemberBinding="{Binding IsNew}" Width="30" Header="New?" />
                    <GridViewColumn DisplayMemberBinding="{Binding IdentificationNumber}" Width="20" Header="ID" />
                    <GridViewColumn DisplayMemberBinding="{Binding Make}" Width="60" Header="Make"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Model}" Width="60" Header="Model"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Year}" Width="35" Header="Year"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Price, StringFormat='c'}" Width="60" Header="Price"/>

                </GridView>
            </ListView.View>
        </ListView>

        <!-- Item 3: Big Output Area -->
        <TextBox x:Name="textOutput" IsEnabled="False" Margin="3" Background="Gray" MinHeight="50" ToolTip="Displays output and status messages"/>

        <!-- Item 4: Buttons at the Bottom -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
            <Button x:Name="buttonEnter" Content="_Enter" MinWidth="45" Margin="5" ToolTip="Click to enter your car" Click="EnterClick" />
            <Button x:Name="buttonReset" Content="_Reset" MinWidth="45" Margin="5" ToolTip="Click to reset the car entry form" Click="ResetClick" />
            <Button x:Name="buttonExit" Content="E_xit" MinWidth="45" Margin="5" ToolTip="Click to exit the program" Click="ExitClick" />

        </StackPanel>

    </StackPanel>
        <Label x:Name="labelStatus" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Grid.Row="1" Height="30" BorderBrush="Black" BorderThickness="2"/>
    </Grid>


// CS file

// THIS IS A COMMENT HEADER
// Kyle
// November 5th
// This program needs a better description written by YOU

using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace CarList2025
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        // Declaration.
        List<Vehicle> listOfVehicles = new List<Vehicle>();


        /// <summary>
        /// Constructor for the form.
        /// </summary>
        public MainWindow()
        {
            InitializeComponent();
            PopulateYears();
            SetDefaults();
            listViewCars.ItemsSource = listOfVehicles;
        }

        /// <summary>
        /// Populate the year combobox with the last 50 years.
        /// </summary>
        public void PopulateYears()
        {
            var currentYear = DateTime.Now.Year;

            for (int year = currentYear; year >= currentYear - 50; year--)
            {
                comboYear.Items.Add(year);
            }
        }

        /// <summary>
        /// Set all form controls back to their default state for new entries.
        /// </summary>
        public void SetDefaults()
        {
            comboMake.SelectedIndex = 0;
            textModel.Clear();
            comboYear.SelectedIndex = 0;
            textPrice.Clear();
            checkIsNew.IsChecked = false;

            listViewCars.SelectedIndex = -1;

            // Set default colours for controls that could be in error.
            Unhighlight(textModel);
            Unhighlight(textPrice);

            comboMake.Focus();
        }

        /// <summary>
        /// When Reset is clicked, reset stuff.
        /// </summary>
        private void ResetClick(object sender, RoutedEventArgs e)
        {
            SetDefaults();
        }

        /// <summary>
        /// Me close form.
        /// </summary>
        private void ExitClick(object sender, RoutedEventArgs e)
        {
            Close();
        }

        /// <summary>
        /// Attempt to add the new vehicle into the list.
        /// </summary>
        private void EnterClick(object sender, RoutedEventArgs e)
        {
            if (double.TryParse(textPrice.Text, out double price))
            {
                try
                {
                    var carToAdd = new Car(comboMake.Text, textModel.Text, int.Parse(comboYear.Text), (decimal)price, checkIsNew.IsChecked == true);
                    listOfVehicles.Add(carToAdd);
                    listViewCars.Items.Refresh();
                    SetDefaults();
                }
                catch (ArgumentNullException ex)
                {
                    // Here's some code that responds to errors in the model I guess?
                }
                catch (ArgumentOutOfRangeException ex)
                {
                    // This is going to respond to errors in the price?
                }
            }
            else
            {
                textOutput.Text = "ERROR: Price must be a number";
                ErrorHighlight(textOutput);
            }
        }

        /// <summary>
        /// Highlight a control that's in error.
        /// </summary>
        /// <param name="boxInError">TextBox that's in error.</param>
        private void ErrorHighlight(TextBox boxInError)
        {
            boxInError.BorderBrush = Brushes.Red;
            boxInError.Background = Brushes.MistyRose;
            boxInError.SelectAll();
            boxInError.Focus();
        }

        /// <summary>
        /// Attempt (badly) to set a control's colours closer to default.
        /// </summary>
        /// <param name="boxToClear">Box you want default colours on.</param>
        private void Unhighlight(TextBox boxToClear)
        {
            boxToClear.BorderBrush = textOutput.BorderBrush;
            boxToClear.Background = Brushes.LightGray;
        }
    }
}
</Window>
